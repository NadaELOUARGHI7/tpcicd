stages:
  - build
  - run

# Job pour construire l'image Docker
build:
  stage: build
  image: docker:24.0.2
  services:
    - docker:24.0.2-dind
  tags:
    - dosi
  script:
    - docker info
    - docker build -t registry.gitlab.com/dosi/pic/elouarghi-nada/tetris:$CI_COMMIT_REF_SLUG .
  only:
    - branches
    
# Job pour ex√©cuter le conteneur
run:
  stage: run
  image: docker:24.0.2
  services:
    - docker:24.0.2-dind
  tags:
    - dosi
  script:
    - docker pull registry.gitlab.com/dosi/pic/elouarghi-nada/tetris:$CI_COMMIT_REF_SLUG
    - docker run -d registry.gitlab.com/dosi/pic/elouarghi-nada/tetris:$CI_COMMIT_REF_SLUG
  only:
    - branches

